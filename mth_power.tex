
% !TEX root = main.tex
\begin{figure}[htbp]
\centering
\begin{tikzpicture}
% Grids
\coordinate (origo) at (0,0);
\coordinate (origo_w) at (5.1,0);

\draw[step=0.3cm,gray,very thin] (-1.51,-1.51) grid (1.5,1.5);
\draw[step=0.3cm,gray,very thin] (3.6,-1.51) grid (6.6, 1.5);

% Axis
\draw[thick, ->] (-1.5,0) -- (1.5, 0) node [anchor=north west]{\Re[$z$]};
\draw[thick, ->] (0,-1.5) -- (0,1.5) node [anchor=south west]{\Im[$z$]};
\draw[thick, ->] (3.6,0) -- (6.6, 0) node [anchor=north west]{\Re[$w$]};
\draw[thick, ->] (5.1,-1.5) -- (5.1,1.5) node [anchor=south west]{\Im[$w$]};

\draw[thick] (0.9, 0) ++(0, 2pt) -- ++(0,-4pt) node[font=\scriptsize, yshift=-0.1cm, xshift=-0.1cm]{1};
\draw[thick] (-0.9, 0) ++(0, 2pt) -- ++(0,-4pt) node[font=\scriptsize, yshift=-0.1cm, xshift=-0.1cm]{-1};
\draw[thick] (0, 0.9) ++(2pt, 0) -- ++(-4pt, 0) node[font=\scriptsize, yshift=-0.1cm, xshift=-0.1cm]{1};
\draw[thick] (0, -0.9) ++(2pt, 0) -- ++(-4pt, 0) node[font=\scriptsize, yshift=-0.1cm, xshift=-0.1cm]{-1};

\draw[thick] (6, 0) ++(0, 2pt) -- ++(0,-4pt) node[font=\scriptsize, yshift=-0.1cm, xshift=-0.1cm]{4};
\draw[thick] (4.2, 0) ++(0, 2pt) -- ++(0,-4pt) node[font=\scriptsize, yshift=-0.1cm, xshift=-0.1cm]{-4};
\draw[thick] (5.1, 0.9) ++(2pt, 0) -- ++(-4pt, 0) node[font=\scriptsize, yshift=-0.1cm, xshift=-0.1cm]{4};
\draw[thick] (5.1, -0.9) ++(2pt, 0) -- ++(-4pt, 0) node[font=\scriptsize, yshift=-0.1cm, xshift=-0.1cm]{-4};

% Plot
\draw[blue,fill=blue] (0.9,0.9) circle (2pt) coordinate[](sample);
\draw[blue,fill=blue] (-0.9,0.9) circle (2pt);
\draw[blue,fill=blue] (0.9,-0.9) circle (2pt);
\draw[blue,fill=blue] (-0.9,-0.9) circle (2pt);
\draw[red,fill=red] (0.73,1.043) circle (2pt) coordinate[](sample_err);

\draw[thin, blue] (0,0) -- (sample);
\draw[thin, red] (0,0) -- (sample_err);
\pic [draw, red, ->, angle eccentricity=1.5] {angle = sample--origo--sample_err};
\draw (0.3, 0.3) node[anchor=north west, text=red, yshift=0.2cm]{$\phi$};

\draw[blue,fill=blue] (3.83,0) circle (2pt) coordinate[](sample_w);
\draw[red,fill=red] (4.125,-0.818) circle (2pt) coordinate[](sample_err_w);
\draw[thin, blue] (origo_w) -- (sample_w);
\draw[thin, red] (origo_w) -- (sample_err_w);
\pic [draw, red, ->, angle eccentricity=1.5] {angle = sample_w--origo_w--sample_err_w};
\draw (origo_w) ++(-1.1,-0.35) node[anchor=north west, text=red, yshift=0.2cm]{$4\phi$};

% Other
\draw[thick, ->] (2, 1) .. controls (2.5,1.1) .. (3,1) node[above, anchor=south east, xshift=0.1cm]{$w=z^4$} ;

\end{tikzpicture}
\caption{Illustration the mapping $w=z^4$ which indicates how a phase error in QPSK modulated signal can be observed.}
\label{fig:mth_pow}
\end{figure}